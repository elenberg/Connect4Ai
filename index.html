<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Connect 4 Learning : ">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Connect 4 Learning</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/elenberg/Connect4Ai">View on GitHub</a>

          <h1 id="project_title">Connect 4 Learning</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/elenberg/Connect4Ai/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/elenberg/Connect4Ai/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a id="abstract" class="anchor" href="#abstract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Abstract</h3>

<p>Connect Four is a beloved game of many youth. It is a game that has 4,531,985,219,092 possible board states [1].  The purpose of this project is to create multiple programs that can intelligently play Connect Four. The programs strategize using one of each: random choices, a Monte Carlo Search tree, a Monte Carlo Search Tree with Database look ups, and a Neural Network.</p>

<h3>
<a id="rules" class="anchor" href="#rules" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rules</h3>

<p>Connect Four is played on a grid with a height of six and a width of seven. In this grid there are seven columns that players may place a chip into, and the chip “falls” to the lowest available space in that column. The game is won when a line can be drawn through four chips from a single player. This  can be done horizontally, diagonally, or vertically.</p>

<p><img src="http://i.imgur.com/XaVfX5e.jpg" alt="Connect 4 Example"></p>

<h3>
<a id="objectives" class="anchor" href="#objectives" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Objectives</h3>

<p>The purpose of this project is to create a program that can play Connect 4 at a high level of ability. This has been done before by following a set of rules known as “Zugzwang”. By following these rules, any game of Connect 4 can be won.[3]
For each of my programs, there are only two rules that are in common:</p>

<ol>
<li>If there is a winning move, make it.</li>
<li>If the opponent can win, block it.</li>
</ol>

<h3>
<a id="methods" class="anchor" href="#methods" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Methods</h3>

<p>The methods used for creating the programs are as follows.</p>

<ul>
<li>Random Choices</li>
<li>Monte Carlo Tree Search</li>
<li>Monte Carlo Tree Search with Lookup</li>
<li>Neural Network</li>
</ul>

<p>For the random choices, it simply makes a random legal move on its turns. For the Monte Carlo Tree Search (MCTS), the program makes a large amount of random choices then uses back propagation to determine which choices had a possibility of winning. See Figure 2. The MCTS Look up is simply looking at a database of winning positions provided by UCI [4] to see if it found a winning position. </p>

<p>This allows it to go through a much higher amount of possible moves. The neural network is trained using the same database and should be able to detect winning board states.</p>

<p><img src="https://i.stack.imgur.com/EieiQ.png" alt="Monte Carlo Tree Search"></p>

<p>The Neural Network I implemented comprised of three primary layers. The first is the input layer. Which takes the board positions as states of 0, 1, 2 representing an empty space, player one, or player two respectively. </p>

<p>Then those positions are processed by 126 Neurons in the input layer. Following that the Hidden layer takes those results and processes it using 42 neurons. </p>

<p>The final adjustment is made by the Output layer which produces a single “confidence” value between 0 and 1 (inclusive). Either a 0 for a losing board state or a 1 for a winning board state.</p>

<p><img src="https://qph.ec.quoracdn.net/main-qimg-050d12c5da82f4f97fdd942d7777b8e4" alt="Neural Network"></p>

<h3>
<a id="results" class="anchor" href="#results" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Results</h3>

<p><img src="http://i.imgur.com/hAIKYu6.png" alt=""></p>

<p><img src="http://i.imgur.com/BQAAs4l.png" alt=""></p>

<p><img src="http://i.imgur.com/5BhRmnr.png" alt=""></p>

<h3>
<a id="conclusions" class="anchor" href="#conclusions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conclusions</h3>

<p>My Neural Network was unexpectedly one of the weakest contenders in the group of programs, performing marginally better than a completely random player. Increasing the number of Neurons and layers would likely improve the accuracy of the Neural Network. </p>

<p>My Monte Carlo Tree Search with a Look up performed the best in the group. It trounces every other program, winning 97% of the games against the Neural Network and 99% of games vs the Random player, when given 1000 ms to make a guess. </p>

<p>I was unable to test my MCTS vs MCTS look up due to time constraints. The average turn count in my test games was 12. In order to get through one set of plays (100 to 1000 vs another 100 MS) it takes over three hours. In order to retrieve the data for the heatmap it took over 46 hours.
If I had more time I would have added more layers to my NN as previously discussed and allowed more time for testing.  </p>

<h3>
<a id="references" class="anchor" href="#references" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>References</h3>

<ul>
<li><a href="http://www.tzi.de/%7Eedelkamp/publications/conf/ki/EdelkampK08-1.pdf">http://www.tzi.de/~edelkamp/publications/conf/ki/EdelkampK08-1.pdf</a></li>
<li><a href="http://www.casualarena.com/bundles/app/st/games/co4/rules/connect-4-rules.jpg?529433742cad32e">http://www.casualarena.com/bundles/app/st/games/co4/rules/connect-4-rules.jpg?529433742cad32e</a></li>
<li>Allis, Louis Victor. A knowledge-based approach of connect-four. Vrije Universiteit, Subfaculteit Wiskunde en Informatica, 1988.</li>
<li><a href="https://i.stack.imgur.com/EieiQ.png">https://i.stack.imgur.com/EieiQ.png</a></li>
<li><a href="https://qph.ec.quoracdn.net/main-qimg-050d12c5da82f4f97fdd942d7777b8e4">https://qph.ec.quoracdn.net/main-qimg-050d12c5da82f4f97fdd942d7777b8e4</a></li>
</ul>

<h3>
<a id="acknowledgments" class="anchor" href="#acknowledgments" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Acknowledgments</h3>

<p>Thank you to Dr. Flann for his assistance is formulating this program. I wouldn’t have been able to get far without his assistance. </p>

<p>Thank you to the Computer Science Department at USU for helping me with ideas for this project.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Connect 4 Learning maintained by <a href="https://github.com/elenberg">elenberg</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
